# Аналитика событий закрытия страницы

## Отслеживаемые события

### События закрытия страницы

- **`beforeunload`** - пользователь пытается покинуть страницу
- **`unload`** - страница выгружается
- **`pagehide`** - страница скрывается (более надежно на мобильных)
- **`window_blur`** - пользователь переключился на другую вкладку/приложение
- **`window_focus`** - пользователь вернулся к странице

### События действий пользователя

- **`click`** - все клики с деталями элемента
- **`scroll_depth`** - глубина прокрутки страницы
- **`exit_intent`** - движение мыши к верхнему краю (намерение покинуть)
- **`page_hidden`** - страница стала невидимой
- **`page_visible`** - страница стала видимой
- **`time_interval`** - каждые 10 секунд активности

### События взаимодействия с CTA

- **`telegram_cta_click`** - клик по кнопке Telegram
- **`whatsapp_cta_click`** - клик по кнопке WhatsApp
- **`no_messenger_info_show`** - показ модального окна "Нет мессенджеров"

## Данные, которые собираются

### Для каждого события:

- `action` - тип действия
- `timestamp` - время события
- `timeOnPage` - время на странице в секундах
- `scrollDepth` - глубина прокрутки в процентах
- `details` - дополнительные детали

### Для событий закрытия:

- `reason` - причина закрытия
- `timeOnPage` - общее время на странице
- `maxScrollDepth` - максимальная глубина прокрутки
- `clickCount` - количество кликов
- `lastActionTime` - время последнего действия
- `userActions` - последние 5 действий пользователя

## Интеграция с аналитикой

События отправляются в:

- **Amplitude** - `Landing.UserAction` и `Landing.PageExit`
- **Yandex.Metrika** - цели `page_exit`
- **Top.Mail.Ru** - цели `page_exit`

## Примеры использования

### Анализ времени на странице

```javascript
// События с timeOnPage покажут, как долго пользователи остаются
```

### Анализ вовлеченности

```javascript
// maxScrollDepth покажет, дошли ли пользователи до конца
// clickCount покажет активность
```

### Анализ причин ухода

```javascript
// reason покажет, как именно пользователь покинул страницу
// userActions покажет, что он делал перед уходом
```
